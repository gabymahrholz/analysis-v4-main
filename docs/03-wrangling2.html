<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Data skills book for Level 2 Psychology students at the School of Psychology and Neuroscience at the University of Glasgow">

<title>3&nbsp; Data wrangling II – Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-dataviz.html" rel="next">
<link href="./02-wrangling.html" rel="prev">
<link href="./images/logos/logo_analysis.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css">
<link rel="stylesheet" href="include/booktem.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/glossary.css">
<link rel="stylesheet" href="include/style.css">
<link rel="stylesheet" href="include/custom.scss">
<link rel="stylesheet" href="include/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-basics.html">INDIVIDUAL WALKTHROUGH CHAPTERS</a></li><li class="breadcrumb-item"><a href="./03-wrangling2.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data wrangling II</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analysis</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">INDIVIDUAL WALKTHROUGH CHAPTERS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Projects and R Markdown</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data wrangling I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-wrangling2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data wrangling II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-dataviz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data viz I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-dataviz2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data viz II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-chi-square-one-sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Chi-square and one-sample t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-independent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Two-sample t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-paired.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Paired t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Correlations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Simple regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Multiple regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-one-way-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">One-way ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-factorial-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Factorial ANOVA</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">IN-LAB: PAIR-CODING</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-A01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2A Lab 1 Week 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-A02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2A Lab 2 Week 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-A03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2A Lab 3 Week 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-A04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2A Lab 4 Week 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-A05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2A Lab 5 Week 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-A06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2A Lab 7 Week 9</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-A07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2A Lab 8 Week 10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-B01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2B Lab 1 Week 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-B02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2B Lab 2 Week 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-B03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2B Lab 3 Week 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-B04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2B Lab 4 Week 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-B05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2B Lab 5 Week 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc-B06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2B Lab 7 Week 9</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-a-installing-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Installing R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-b-updating-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Updating R, RStudio, and packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-d-symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Symbols</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-x-How-to-cite-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Citing R and RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-y-license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">License</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<div class="brand-banner">
  <a class="no-external-icon" href="https://psyteachr.github.io/" target="_blank" rel="noopener">
    <img class="nolightbox" src="images/logos/PsyTeachR_books.png" alt="PsyTeachR Books">
    </a>
    </div>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#intended-learning-outcomes" id="toc-intended-learning-outcomes" class="nav-link active" data-scroll-target="#intended-learning-outcomes">Intended Learning Outcomes</a></li>
  <li><a href="#individual-walkthrough" id="toc-individual-walkthrough" class="nav-link" data-scroll-target="#individual-walkthrough"><span style="color: #F39C12; text-transform: uppercase;">Individual Walkthrough</span></a></li>
  <li><a href="#activity-1-setup" id="toc-activity-1-setup" class="nav-link" data-scroll-target="#activity-1-setup"><span class="header-section-number">3.1</span> Activity 1: Setup</a></li>
  <li><a href="#activity-2-load-in-the-libraries-and-read-in-the-data" id="toc-activity-2-load-in-the-libraries-and-read-in-the-data" class="nav-link" data-scroll-target="#activity-2-load-in-the-libraries-and-read-in-the-data"><span class="header-section-number">3.2</span> Activity 2: Load in the libraries and read in the data</a></li>
  <li><a href="#sec-wrangling2_act3" id="toc-sec-wrangling2_act3" class="nav-link" data-scroll-target="#sec-wrangling2_act3"><span class="header-section-number">3.3</span> Activity 3: Confidence in understanding Open Science practices</a></li>
  <li><a href="#sec-wrangling2_act4" id="toc-sec-wrangling2_act4" class="nav-link" data-scroll-target="#sec-wrangling2_act4"><span class="header-section-number">3.4</span> Activity 4: Survey of Attitudes Toward Statistics (SATS-28)</a></li>
  <li><a href="#activity-5-error-mode-perceptions-of-supervisory-support" id="toc-activity-5-error-mode-perceptions-of-supervisory-support" class="nav-link" data-scroll-target="#activity-5-error-mode-perceptions-of-supervisory-support"><span class="header-section-number">3.5</span> Activity 5 (Error Mode): Perceptions of supervisory support</a></li>
  <li><a href="#activity-6-join-everything-together-with-_join" id="toc-activity-6-join-everything-together-with-_join" class="nav-link" data-scroll-target="#activity-6-join-everything-together-with-_join"><span class="header-section-number">3.6</span> Activity 6: Join everything together with <code>???_join()</code></a></li>
  <li><a href="#activity-7-knit-and-export" id="toc-activity-7-knit-and-export" class="nav-link" data-scroll-target="#activity-7-knit-and-export"><span class="header-section-number">3.7</span> Activity 7: Knit and export</a></li>
  <li><a href="#test-your-knowledge-and-challenge-yourself" id="toc-test-your-knowledge-and-challenge-yourself" class="nav-link" data-scroll-target="#test-your-knowledge-and-challenge-yourself"><span style="color: #F39C12; text-transform: uppercase;">Test your knowledge and challenge yourself</span></a>
  <ul class="collapse">
  <li><a href="#knowledge-check" id="toc-knowledge-check" class="nav-link" data-scroll-target="#knowledge-check">Knowledge check</a></li>
  <li><a href="#challenge-yourself" id="toc-challenge-yourself" class="nav-link" data-scroll-target="#challenge-yourself">Challenge yourself</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-basics.html">INDIVIDUAL WALKTHROUGH CHAPTERS</a></li><li class="breadcrumb-item"><a href="./03-wrangling2.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data wrangling II</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-wrangling2" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data wrangling II</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="intended-learning-outcomes" class="level2 unnumbered">
<h2 class="unnumbered" data-anchor-id="intended-learning-outcomes">Intended Learning Outcomes</h2>
<p>By the end of this chapter, you should be able to:</p>
<ul>
<li>apply familiar data wrangling functions to novel datasets</li>
<li>read and interpret error messages</li>
<li>realise there are several ways of getting to the results</li>
</ul>
<p>In this chapter, we will pick up where we left off in <a href="02-wrangling.html" class="quarto-xref"><span>Chapter 2</span></a>. We will calculate average scores for two of the questionnaires, address an error mode problem, and finally, join all data objects together. This will finalise our data for the upcoming data visualization sections (<a href="04-dataviz.html" class="quarto-xref"><span>Chapter 4</span></a> and <a href="05-dataviz2.html" class="quarto-xref"><span>Chapter 5</span></a>).</p>
</section>
<section id="individual-walkthrough" class="level2 unnumbered">
<h2 class="unnumbered" data-anchor-id="individual-walkthrough"><span style="color: #F39C12; text-transform: uppercase;">Individual Walkthrough</span></h2>
</section>
<section id="activity-1-setup" class="level2" data-number="3.1">
<h2 data-number="3.1" data-anchor-id="activity-1-setup"><span class="header-section-number">3.1</span> Activity 1: Setup</h2>
<ul>
<li>Go to the project folder we have been using in the last two weeks and double-click on the project icon to <strong>open the project</strong> in RStudio</li>
<li>Either <strong>Create a new <code>.Rmd</code> file</strong> for chapter 3 and save it to your project folder or continue the one from last week. See <a href="01-basics.html#sec-rmd" class="quarto-xref"><span>Section 1.3</span></a> if you need some guidance.</li>
</ul>
</section>
<section id="activity-2-load-in-the-libraries-and-read-in-the-data" class="level2" data-number="3.2">
<h2 data-number="3.2" data-anchor-id="activity-2-load-in-the-libraries-and-read-in-the-data"><span class="header-section-number">3.2</span> Activity 2: Load in the libraries and read in the data</h2>
<p>Today, we will be using <code>tidyverse</code> along with the two csv files created at the end of the last chapter: <code>data_prp_for_ch3.csv</code> and <code>qrp_t1.csv</code>. If you need to download them again for any reason, click on the following links: <a href="data/data_prp_for_ch3.csv" title="download">data_prp_for_ch3.csv</a> and <a href="data/qrp_t1.csv" title="download">qrp_t1.csv</a>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(???)</span>
<span id="cb1-2"><a href="#cb1-2"></a>data_prp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"???"</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>qrp_t1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"???"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2"></a>data_prp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"prp_data_reduced.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>qrp_t1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"qrp_t1.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>If you need a quick reminder what the dataset was about, have a look at the abstract in <a href="01-basics.html#sec-download_data_ch1" class="quarto-xref"><span>Section 1.4</span></a>. We also addressed the changes we made to the dataset there.</p>
<p>And remember to have a quick <code>glimpse()</code> at your data.</p>
</section>
<section id="sec-wrangling2_act3" class="level2" data-number="3.3">
<h2 data-number="3.3" data-anchor-id="sec-wrangling2_act3"><span class="header-section-number">3.3</span> Activity 3: Confidence in understanding Open Science practices</h2>
<section id="the-main-goal-is-to-compute-the-mean-understanding-score-per-participant." class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="the-main-goal-is-to-compute-the-mean-understanding-score-per-participant.">The main goal is to compute the mean Understanding score per participant.</h4>
<p>The mean Understanding score for time point 2 has already been calculated (in the <code>Time2_Understanding_OS</code> column), but we still need to compute it for time point 1.</p>
<p>Looking at the Understanding data at time point 1, you determine that</p>
<ul>
<li>individual item columns are <select class="webex-select"><option value="blank"></option><option value="x">numeric</option><option value="answer">character</option></select>, and</li>
<li>according to the codebook, there are <select class="webex-select"><option value="blank"></option><option value="answer">no</option><option value="x">some</option></select> reverse-coded items in this questionnaire.</li>
</ul>
<p>The steps are quite similar to those for QRP, but we need to add an extra step: converting the character labels into numbers.</p>
<p>Again, let’s do this step by step:</p>
<ul>
<li><strong>Step 1</strong>: Select the relevant columns <code>Code</code>, and every Understanding column from time point 1 (e.g., from <code>Understanding_OS_1_Time1</code> to <code>Understanding_OS_12_Time1</code>) and store them in an object called <code>understanding_t1</code></li>
<li><strong>Step 2</strong>: Pivot the data from wide format to long format using <code>pivot_longer()</code> so we can recode the labels into values (step 3) and calculate the average score (in step 4) more easily</li>
<li><strong>Step 3</strong>: Recode the values “Not at all confident” as 1 and “Entirely confident” as 7. All other values are already numbers. We can use functions <code>mutate()</code> in combination with <code>case_match()</code> for that</li>
<li><strong>Step 4</strong>: Calculate the average Understanding Open Science score (<code>Time1_Understanding_OS</code>) per participant using <code>group_by()</code> and <code>summarise()</code></li>
</ul>
</section>
<section id="steps-1-and-2-select-and-pivot" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="steps-1-and-2-select-and-pivot">Steps 1 and 2: Select and pivot</h4>
<p>How about you try the first 2 steps yourself using the code from Chapter 2 Activity 4 (<a href="02-wrangling.html#sec-ch2_act4" class="quarto-xref"><span>Section 2.4</span></a>) as a template?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>understanding_t1 <span class="ot">&lt;-</span> data_prp <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">select</span>(???) <span class="sc">%&gt;%</span> <span class="co"># Step 1</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> ???, <span class="at">names_to =</span> <span class="st">"???"</span>, <span class="at">values_to =</span> <span class="st">"???"</span>) <span class="co"># Step 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution for steps 1 and 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>understanding_t1 <span class="ot">&lt;-</span> data_prp <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="co"># Step 1</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">select</span>(Code, Understanding_OS_1_Time1<span class="sc">:</span>Understanding_OS_12_Time1) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="co"># Step 2 - I picked different column labels this time for some variety</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Understanding_OS_1_Time1<span class="sc">:</span>Understanding_OS_12_Time1, <span class="at">names_to =</span> <span class="st">"Understanding_Qs"</span>, <span class="at">values_to =</span> <span class="st">"Responses"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="step-3-recoding-the-values" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="step-3-recoding-the-values">Step 3: recoding the values</h4>
<p>OK, we now want to recode the values in the <code>Responses</code> column (or whatever name you picked for your column that has some of the numbers in it) so that “Not at all confident” = 1 and “Entirely confident” = 7. We want to keep all other values as they are (2-6 look already quite “numeric”).</p>
<p>Let’s create a new column <code>Responses_corrected</code> that stores the new values with <code>mutate()</code>. Then we can combine that with the <code>case_match()</code> function.</p>
<ul>
<li>The first argument in <code>case_match()</code> is the column name of the variable you want to recode.</li>
<li>Then you can start recoding the values in the way of <code>CurrentValue ~ NewValue</code> (~ is a tilde). Make sure you use the <code>~</code> and not <code>=</code>!</li>
<li>Lastly, the <code>.default</code> argument tells R what to do with values that are neither “Not at all confident” nor “Entirely confident”. Here, we want to replace them with the original value of the <code>Responses</code> column. In other datasets, you may want to set the default to <code>NA</code> for missing values, a character string or a number, and <code>case_match()</code> is happy to oblige.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>understanding_t1 <span class="ot">&lt;-</span> understanding_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">mutate</span>(<span class="at">Responses_corrected =</span> <span class="fu">case_match</span>(Responses, <span class="co"># column of the values to recode</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>                                          <span class="st">"Not at all confident"</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># values to recode</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>                                          <span class="st">"Entirely confident"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb5-5"><a href="#cb5-5"></a>                                          <span class="at">.default =</span> Responses <span class="co"># all other values taken from column Responses</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `mutate()`:
ℹ In argument: `Responses_corrected = case_match(...)`.
Caused by error in `case_match()`:
! Can't combine `..1 (right)` &lt;double&gt; and `.default` &lt;character&gt;.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Error!!! Can you explain what is happening here?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Have a look at the error message. It’s pretty helpful this time. It says <code>Can't combine ..1 (right) &lt;double&gt; and .default &lt;character&gt;.</code> It means that the replacement values are expected to be data type character since the original column type was type character.</p>
</div>
</div>
</div>
<p><strong>So how do we fix this?</strong> Actually, there are several ways this could be done. Click on the tabs below to check out 3 possible solutions.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="layers">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Fix option 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Fix option 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Fix option 3</a></li></ul>
<div class="tab-content" data-group="layers">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>One option is to modify the <code>.default</code> argument <code>Responses</code> so that the values are copied over from the original column but as a number rather than the original character value. The function <code>as.numeric()</code> does the conversion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>understanding_t1_step3_v1 <span class="ot">&lt;-</span> understanding_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">mutate</span>(<span class="at">Responses_corrected =</span> <span class="fu">case_match</span>(Responses, <span class="co"># column of the values to recode</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>                                          <span class="st">"Not at all confident"</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># values to recode</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>                                          <span class="st">"Entirely confident"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb7-5"><a href="#cb7-5"></a>                                          <span class="at">.default =</span> <span class="fu">as.numeric</span>(Responses) <span class="co"># all other values taken from column Responses but as numeric data type </span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Change the numeric values on the right side of the <code>~</code> to character. Then in a second step, we would need to turn the character column into a numeric type. Again, we have several options to do so. We could either use the <code>parse_number()</code> function we encountered earlier during the demographics wrangling or the <code>as.numeric()</code> function.</p>
<ul>
<li>V1: <code>Responses_corrected = parse_number(Responses_corrected)</code></li>
<li>V2: <code>Responses_corrected = as.numeric(Responses_corrected)</code></li>
</ul>
<p>Just pay attention that you are still working <em>within</em> the <code>mutate()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>understanding_t1_step3_v2 <span class="ot">&lt;-</span> understanding_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">mutate</span>(<span class="at">Responses_corrected =</span> <span class="fu">case_match</span>(Responses, <span class="co"># column of the values to recode</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>                                          <span class="st">"Not at all confident"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb8-4"><a href="#cb8-4"></a>                                          <span class="st">"Entirely confident"</span> <span class="sc">~</span> <span class="st">"7"</span>,</span>
<span id="cb8-5"><a href="#cb8-5"></a>                                          <span class="at">.default =</span> Responses <span class="co"># all other values taken from column Responses (character)</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>  ),</span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="at">Responses_corrected =</span> <span class="fu">parse_number</span>(Responses_corrected)) <span class="co"># turning Responses_corrected into a numeric column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>If you recode all the labels into numbers (e.g., “2” into 2, “3” into 3, etc.) from the start, you won’t need to perform any additional conversions later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>understanding_t1_step3_v2 <span class="ot">&lt;-</span> understanding_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">mutate</span>(<span class="at">Responses_recoded =</span> <span class="fu">case_match</span>(Responses, <span class="co"># column of the values to recode</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>                                        <span class="st">"Not at all confident"</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># recode all of them</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>                                        <span class="st">"2"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb9-5"><a href="#cb9-5"></a>                                        <span class="st">"3"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb9-6"><a href="#cb9-6"></a>                                        <span class="st">"4"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb9-7"><a href="#cb9-7"></a>                                        <span class="st">"5"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb9-8"><a href="#cb9-8"></a>                                        <span class="st">"6"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb9-9"><a href="#cb9-9"></a>                                        <span class="st">"Entirely confident"</span> <span class="sc">~</span> <span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Your Turn
</div>
</div>
<div class="callout-body-container callout-body">
<p>Choose the option that works best for you to <strong>modify the code of <code>understanding_t1</code></strong> above that didn’t work/ gave you an error message. Once you do that, you should be able to calculate the <strong>mean Understanding Score per participant</strong>. Store the average scores in a variable called <code>Time1_Understanding_OS</code>. If you need help, refer to the hint below or use Chapter 2 Activity 4 (<a href="02-wrangling.html#sec-ch2_act4" class="quarto-xref"><span>Section 2.4</span></a>) as guidance.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
One solution for Steps 3 and 4
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>understanding_t1 <span class="ot">&lt;-</span> understanding_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="co"># Step 3</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">mutate</span>(<span class="at">Responses_corrected =</span> <span class="fu">case_match</span>(Responses, <span class="co"># column of the values to recode</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>                                          <span class="st">"Not at all confident"</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># values to recode</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>                                          <span class="st">"Entirely confident"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb10-6"><a href="#cb10-6"></a>                                          <span class="at">.default =</span> <span class="fu">as.numeric</span>(Responses) <span class="co"># all other values taken from column Responses but as numeric data type </span></span>
<span id="cb10-7"><a href="#cb10-7"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="co"># Step 4: calculating averages per participant</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="fu">group_by</span>(Code) <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="fu">summarise</span>(<span class="at">Time1_Understanding_OS =</span> <span class="fu">mean</span>(Responses_corrected)) <span class="sc">%&gt;%</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Of course, this could have been written up as a single pipe.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Single pipe of activity 3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>understanding_t1 <span class="ot">&lt;-</span> data_prp <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="co"># Step 1</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">select</span>(Code, Understanding_OS_1_Time1<span class="sc">:</span>Understanding_OS_12_Time1) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="co"># Step 2</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Code, <span class="at">names_to =</span> <span class="st">"Understanding_Qs"</span>, <span class="at">values_to =</span> <span class="st">"Responses"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="co"># Step 3</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="fu">mutate</span>(<span class="at">Responses_corrected =</span> <span class="fu">case_match</span>(Responses, <span class="co"># column of the values to recode</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>                                          <span class="st">"Not at all confident"</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># values to recode</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>                                          <span class="st">"Entirely confident"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb11-10"><a href="#cb11-10"></a>                                          <span class="at">.default =</span> <span class="fu">as.numeric</span>(Responses) <span class="co"># all other values taken from column Responses but as numeric data type </span></span>
<span id="cb11-11"><a href="#cb11-11"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb11-12"><a href="#cb11-12"></a>  <span class="co"># Step 4</span></span>
<span id="cb11-13"><a href="#cb11-13"></a>  <span class="fu">group_by</span>(Code) <span class="sc">%&gt;%</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>  <span class="fu">summarise</span>(<span class="at">Time1_Understanding_OS =</span> <span class="fu">mean</span>(Responses_corrected)) <span class="sc">%&gt;%</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-wrangling2_act4" class="level2" data-number="3.4">
<h2 data-number="3.4" data-anchor-id="sec-wrangling2_act4"><span class="header-section-number">3.4</span> Activity 4: Survey of Attitudes Toward Statistics (SATS-28)</h2>
<section id="the-main-goal-is-to-compute-the-mean-sats-28-score-for-each-of-the-4-subscales-per-participant-for-time-point-1." class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="the-main-goal-is-to-compute-the-mean-sats-28-score-for-each-of-the-4-subscales-per-participant-for-time-point-1.">The main goal is to compute the mean SATS-28 score for each of the 4 subscales per participant for time point 1.</h4>
<p>Looking at the SATS data at time point 1, you determine that</p>
<ul>
<li>individual item columns are <select class="webex-select"><option value="blank"></option><option value="answer">numeric</option><option value="x">character</option></select>, and</li>
<li>according to the codebook, there are <select class="webex-select"><option value="blank"></option><option value="x">no</option><option value="answer">some</option></select> reverse-coded items in this questionnaire.</li>
<li>Additionally, we are looking to compute the means for the 4 different subscales of the SAT-28 which are <input class="webex-solveme nospaces ignorecase" size="6" data-answer="[&quot;Affect&quot;]">, <input class="webex-solveme nospaces ignorecase" size="20" data-answer="[&quot;Cognitive Competence&quot;]">, <input class="webex-solveme nospaces ignorecase" size="5" data-answer="[&quot;Value&quot;]">, and <input class="webex-solveme nospaces ignorecase" size="10" data-answer="[&quot;Difficulty&quot;]">.</li>
</ul>
<p>This scenario is slightly more tricky than the previous ones due to the reverse-coding and the 4 subscales. So, let’s tackle this step by step again:</p>
<ul>
<li><strong>Step 1</strong>: Select the relevant columns <code>Code</code>, and every SATS28 column from time point 1 (e.g., from <code>SATS28_1_Affect_Time1</code> to <code>SATS28_28_Difficulty_Time1</code>) and store them in an object called <code>sats_t1</code></li>
<li><strong>Step 2</strong>: Pivot the data from wide format to long format using <code>pivot_longer()</code> so we can recode the labels into values (step 3) and calculate the average score (in step 4) more easily</li>
<li><strong>Step 3</strong>: We need to know which items belong to which subscale - fortunately, we have that information in the variable name and can use the <code>separate()</code> function to access it.</li>
<li><strong>Step 4</strong>: We need to know which items are reverse-coded and then reverse-score them - unfortunately, the info is only in the codebook and we need to find a work-around. <code>case_when()</code> can help identify and re-score the reverse-coded items.</li>
<li><strong>Step 5</strong>: Calculate the average SATS score per participant and subscale using <code>group_by()</code> and <code>summarise()</code></li>
<li><strong>Step 6</strong>: use <code>pivot_wider()</code> to spread out the dataframe into wide format and <code>rename()</code> to tidy up the column names</li>
</ul>
</section>
<section id="steps-1-and-2-select-and-pivot-1" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="steps-1-and-2-select-and-pivot-1">Steps 1 and 2: select and pivot</h4>
<p>The selecting and pivoting are exactly the same way as we already practiced in the other 2 questionnaires. Apply them here to this questionnaire.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>sats_t1 <span class="ot">&lt;-</span> data_prp <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">select</span>(???) <span class="sc">%&gt;%</span> <span class="co"># Step 1</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> ???, <span class="at">names_to =</span> <span class="st">"???"</span>, <span class="at">values_to =</span> <span class="st">"???"</span>) <span class="co"># Step 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution for steps 1 and 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>sats_t1 <span class="ot">&lt;-</span> data_prp <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">select</span>(Code, SATS28_1_Affect_Time1<span class="sc">:</span>SATS28_28_Difficulty_Time1) <span class="sc">%&gt;%</span> <span class="co"># Step 1</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Code, <span class="at">names_to =</span> <span class="st">"Items"</span>, <span class="at">values_to =</span> <span class="st">"Response"</span>) <span class="co"># Step 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="step-3-separate-subscale-information" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="step-3-separate-subscale-information">Step 3: separate Subscale information</h4>
<p>If you look at the <code>Items</code> column more closely, you can see that there is information on the <code>Questionnaire</code>, the <code>Item_number</code>, the <code>Subscale</code>, and the <code>Timepoint</code> the data was collected at.</p>
<p>We can separate the information into separate columns using the <code>separate()</code> function. The function’s first argument is the column to separate, then define <code>into</code> which columns you want the original column to split up, and lastly, define the separator <code>sep</code> (here an underscore). For our example, we would write:</p>
<ul>
<li>V1: <code>separate(Items, into = c("SATS", "Item_number", "Subscale", "Time"), sep = "_")</code></li>
</ul>
<p>However, we don’t need all of those columns, so we could just drop the ones we are not interested in by replacing them with <code>NA</code>.</p>
<ul>
<li>V2: <code>separate(Items, into = c(NA, "Item_number", "Subscale", NA), sep = "_")</code></li>
</ul>
<p>We might also add an extra argument of <code>convert = TRUE</code> to have numeric columns (i.e., <code>Item_number</code>) converted to numeric as opposed to keeping them as characters. Saves us typing a few quotation marks later in Step 4.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>sats_t1 <span class="ot">&lt;-</span> sats_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="co"># Step 3</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">separate</span>(Items, <span class="at">into =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"Item_number"</span>, <span class="st">"Subscale"</span>, <span class="cn">NA</span>), <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-4-identifying-reverse-coded-items-and-then-correct-them" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="step-4-identifying-reverse-coded-items-and-then-correct-them">Step 4: identifying reverse-coded items and then correct them</h4>
<p>We can use <code>case_when()</code> within the <code>mutate()</code> function here to create a new column <code>FW_RV</code> that stores information on whether the item is a reverse-coded item or not.</p>
<p><code>case_when()</code> works similarly to <code>case_match()</code>, however <code>case_match()</code> only allows us to “recode” values (i.e., replace one value with another), whereas <code>case_when()</code> is more flexible. It allows us to use <strong>conditional statements</strong> on the left side of the tilde which is useful when you want to change only <em>some</em> of the data based on specific conditions.</p>
<p>Looking at the codebook, it seems that items 2, 3, 4, 6, 7, 8, 9, 12, 13, 16, 17, 19, 20, 21, 23, 25, 26, 27, and 28 are reverse-coded. The rest are forward-coded.</p>
<p>We want to tell R now, that</p>
<ul>
<li><strong>if</strong> the <code>Item_number</code> is any of those numbers listed above, R should write “Reverse” into the new column <code>FW_RV</code> we are creating. Since we have a few possible matches for <code>Item_number</code>, we need the Boolean expression <code>%in%</code> rather than <code>==</code>.</li>
<li><strong>if</strong> <code>Item_number</code> is none of those numbers, then we would like the word “Forward” in the <code>FW_RV</code> column to appear. We can achieve that by specifying a <code>.default</code> argument again, but this time we want a “word” rather than a value from another column.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>sats_t1 <span class="ot">&lt;-</span> sats_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">mutate</span>(<span class="at">FW_RV =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-3"><a href="#cb15-3"></a>    Item_number <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">28</span>) <span class="sc">~</span> <span class="st">"Reverse"</span>,</span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="at">.default =</span> <span class="st">"Forward"</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moving on to correcting the scores: Once again, we can use <code>case_when ()</code> within the <code>mutate()</code> function to create another <strong>conditional statement</strong>. This time, the condition is:</p>
<ul>
<li><strong>if</strong> <code>FW_RV</code> column has a value of “Reverse” then we would like to turn all 1 into 7, 2 into 6, etc.</li>
<li><strong>if</strong> <code>FW_RV</code> column has a value of “Forward” then we would like to keep the score from the <code>Response</code> column</li>
</ul>
<p>There is a quick way and a not-so-quick way to achieve the actual <strong>reverse-coding</strong>.</p>
<ul>
<li><strong>Option 1 (quick)</strong>: The easiest way to reverse-code scores is to take the maximum value of the scale, add 1 unit, and subtract the original value. For example, on a 5-point Likert scale, it would be 6 minus the original rating; for a 7-point Likert scale, 8 minus the original rating, etc. (see <em>Option 1</em> tab).</li>
<li><strong>Option 2 (not so quick)</strong>: This involves using two conditional statements (see <em>Option 2</em> tab).</li>
</ul>
<p>Use the one you find more intuitive.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Option 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Option 2</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Here we are using a Boolean expression to check if the string “Reverse” is present in the <code>FW_RV</code> column. If this condition is <code>TRUE</code>, the value in the new column we’re creating, <code>Scores_corrected</code>, will be calculated as 8 minus the value from the Response column. If the condition is FALSE (handled by the .default argument), the original values from the <code>Response</code> column will be retained.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>sats_t1 <span class="ot">&lt;-</span> sats_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">mutate</span>(<span class="at">Scores_corrected =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-3"><a href="#cb16-3"></a>    FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">~</span> <span class="dv">8</span><span class="sc">-</span>Response,</span>
<span id="cb16-4"><a href="#cb16-4"></a>    <span class="at">.default =</span> Response</span>
<span id="cb16-5"><a href="#cb16-5"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>As stated above, the longer approach involves using two conditional statements. The first condition checks if the value in the <code>FW_RV</code> column is “Reverse”, while the second condition checks if the value in the <code>Response</code> column equals a specific number. <strong>When both conditions are met</strong>, the corresponding value on the right side of the tilde is placed in the newly created <code>Scores_corrected_v2</code> column.</p>
<p>For example, line 3 would read: if the value in the <code>FW_RV</code> column is “Reverse” <strong>AND</strong> the value in the <code>Response</code> column is 1, then assign a value of 7 to the <code>Scores_corrected_v2</code> column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>sats_t1 <span class="ot">&lt;-</span> sats_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">mutate</span>(<span class="at">Scores_corrected_v2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-3"><a href="#cb17-3"></a>    FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">&amp;</span> Response <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>    FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">&amp;</span> Response <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb17-5"><a href="#cb17-5"></a>    FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">&amp;</span> Response <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb17-6"><a href="#cb17-6"></a>    <span class="co"># no need to recode 4 as 4</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>    FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">&amp;</span> Response <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb17-8"><a href="#cb17-8"></a>    FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">&amp;</span> Response <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb17-9"><a href="#cb17-9"></a>    FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">&amp;</span> Response <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb17-10"><a href="#cb17-10"></a>    <span class="at">.default =</span> Response</span>
<span id="cb17-11"><a href="#cb17-11"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As you can see now in <code>sats_t1</code>, both columns <code>Scores_corrected</code> and <code>Scores_corrected_v2</code> are identical.</p>
</div>
</div>
</div>
<p>One way to <strong>check whether our reverse-coding worked</strong> is by examining the <code>distinct</code> values in the original <code>Response</code> column and comparing them with the <code>Scores_corrected</code>. We should also retain the <code>FW_RV</code> column to observe how the reverse-coding applied.</p>
<p>To see the patterns more clearly, we can use <code>arrange()</code> to sort the values in a meaningful order. Remember, the default sorting order is ascending, so if you want to sort values in descending order, you’ll need to wrap your variable in the <code>desc()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>check_coding <span class="ot">&lt;-</span> sats_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">distinct</span>(FW_RV, Response, Scores_corrected) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(FW_RV), Response)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show <code>check_coding</code> output
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>check_coding</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">FW_RV</th>
<th style="text-align: right;">Response</th>
<th style="text-align: right;">Scores_corrected</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Reverse</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Reverse</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reverse</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Reverse</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reverse</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Reverse</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reverse</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Forward</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Forward</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Forward</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Forward</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Forward</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Forward</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Forward</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="step-5" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="step-5">Step 5</h4>
<p>Now that we know everything worked out as intended, we can calculate the mean scores of each subscale for each participant in <code>sats_t1</code>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>sats_t1 <span class="ot">&lt;-</span> sats_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">group_by</span>(???, ???) <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">summarise</span>(<span class="at">mean_score =</span> ???(???)) <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>sats_t1 <span class="ot">&lt;-</span> sats_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">group_by</span>(Code, Subscale) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">summarise</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(Scores_corrected)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Code'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="step-6" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="step-6">Step 6</h4>
<p>The final step is to transform the data back into wide format, ensuring that each subscale has its own column. This will make it easier to join the data objects later on. In <code>pivot_wider()</code>, the first argument, <code>names_from</code>, specifies the column you want to use for your new column headings. The second argument, <code>values_from</code>, tells R which column should provide the cell values.</p>
<p>We should also <strong>rename the column names</strong> to match those in the codebook. Conveniently, we can use a function called <code>rename()</code> that works exactly like <code>select()</code> (following the pattern <code>new_name = old_name</code>), but it keeps all other column names the same rather than reducing the number of columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>sats_t1 <span class="ot">&lt;-</span> sats_t1 <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Subscale, <span class="at">values_from =</span> mean_score) <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">rename</span>(<span class="at">SATS28_Affect_Time1_mean =</span> Affect,</span>
<span id="cb23-4"><a href="#cb23-4"></a>         <span class="at">SATS28_CognitiveCompetence_Time1_mean =</span> CognitiveCompetence,</span>
<span id="cb23-5"><a href="#cb23-5"></a>         <span class="at">SATS28_Value_Time1_mean =</span> Value,</span>
<span id="cb23-6"><a href="#cb23-6"></a>         <span class="at">SATS28_Difficulty_Time1_mean =</span> Difficulty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show final <code>sats_t1</code> output
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">head</span>(sats_t1, <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 20%">
<col style="width: 31%">
<col style="width: 23%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Code</th>
<th style="text-align: right;">SATS28_Affect_Time1_mean</th>
<th style="text-align: right;">SATS28_CognitiveCompetence_Time1_mean</th>
<th style="text-align: right;">SATS28_Difficulty_Time1_mean</th>
<th style="text-align: right;">SATS28_Value_Time1_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AD03</td>
<td style="text-align: right;">2.333333</td>
<td style="text-align: right;">3.833333</td>
<td style="text-align: right;">3.428571</td>
<td style="text-align: right;">5.555556</td>
</tr>
<tr class="even">
<td style="text-align: left;">AD05</td>
<td style="text-align: right;">3.500000</td>
<td style="text-align: right;">5.000000</td>
<td style="text-align: right;">2.142857</td>
<td style="text-align: right;">4.777778</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ab01</td>
<td style="text-align: right;">5.166667</td>
<td style="text-align: right;">5.666667</td>
<td style="text-align: right;">4.142857</td>
<td style="text-align: right;">5.444444</td>
</tr>
<tr class="even">
<td style="text-align: left;">Al05</td>
<td style="text-align: right;">2.166667</td>
<td style="text-align: right;">2.666667</td>
<td style="text-align: right;">2.857143</td>
<td style="text-align: right;">3.777778</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Am05</td>
<td style="text-align: right;">4.166667</td>
<td style="text-align: right;">5.666667</td>
<td style="text-align: right;">5.571429</td>
<td style="text-align: right;">4.888889</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Again, this could have been written up as a single pipe.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Single pipe of activity 4
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>sats_t1 <span class="ot">&lt;-</span> data_prp <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="co"># Step 1</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">select</span>(Code, SATS28_1_Affect_Time1<span class="sc">:</span>SATS28_28_Difficulty_Time1) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="co"># Step 2</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Code, <span class="at">names_to =</span> <span class="st">"Items"</span>, <span class="at">values_to =</span> <span class="st">"Response"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="co"># Step 3</span></span>
<span id="cb25-7"><a href="#cb25-7"></a>  <span class="fu">separate</span>(Items, <span class="at">into =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"Item_number"</span>, <span class="st">"Subscale"</span>, <span class="cn">NA</span>), <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-8"><a href="#cb25-8"></a>  <span class="co"># step 4</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>  <span class="fu">mutate</span>(<span class="at">FW_RV =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-10"><a href="#cb25-10"></a>    Item_number <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">19</span>, <span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>, <span class="dv">28</span>) <span class="sc">~</span> <span class="st">"Reverse"</span>,</span>
<span id="cb25-11"><a href="#cb25-11"></a>    <span class="at">.default =</span> <span class="st">"Forward"</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>  ),</span>
<span id="cb25-13"><a href="#cb25-13"></a>    <span class="at">Scores_corrected =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-14"><a href="#cb25-14"></a>      FW_RV <span class="sc">==</span> <span class="st">"Reverse"</span> <span class="sc">~</span> <span class="dv">8</span><span class="sc">-</span>Response,</span>
<span id="cb25-15"><a href="#cb25-15"></a>      <span class="at">.default =</span> Response</span>
<span id="cb25-16"><a href="#cb25-16"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb25-17"><a href="#cb25-17"></a>  <span class="co"># step 5</span></span>
<span id="cb25-18"><a href="#cb25-18"></a>  <span class="fu">group_by</span>(Code, Subscale) <span class="sc">%&gt;%</span> </span>
<span id="cb25-19"><a href="#cb25-19"></a>  <span class="fu">summarise</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(Scores_corrected)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-20"><a href="#cb25-20"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb25-21"><a href="#cb25-21"></a>  <span class="co"># step 6</span></span>
<span id="cb25-22"><a href="#cb25-22"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Subscale, <span class="at">values_from =</span> mean_score) <span class="sc">%&gt;%</span> </span>
<span id="cb25-23"><a href="#cb25-23"></a>  <span class="fu">rename</span>(<span class="at">SATS28_Affect_Time1_mean =</span> Affect,</span>
<span id="cb25-24"><a href="#cb25-24"></a>         <span class="at">SATS28_CognitiveCompetence_Time1_mean =</span> CognitiveCompetence,</span>
<span id="cb25-25"><a href="#cb25-25"></a>         <span class="at">SATS28_Value_Time1_mean =</span> Value,</span>
<span id="cb25-26"><a href="#cb25-26"></a>         <span class="at">SATS28_Difficulty_Time1_mean =</span> Difficulty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="activity-5-error-mode-perceptions-of-supervisory-support" class="level2" data-number="3.5">
<h2 data-number="3.5" data-anchor-id="activity-5-error-mode-perceptions-of-supervisory-support"><span class="header-section-number">3.5</span> Activity 5 (Error Mode): Perceptions of supervisory support</h2>
<section id="the-main-goal-is-to-compute-the-mean-score-for-perceived-supervisory-support-per-participant." class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="the-main-goal-is-to-compute-the-mean-score-for-perceived-supervisory-support-per-participant.">The main goal is to compute the mean score for perceived supervisory support per participant.</h4>
<p>Looking at the supervisory support data, you determine that</p>
<ul>
<li>individual item columns are <select class="webex-select"><option value="blank"></option><option value="answer">numeric</option><option value="x">character</option></select>, and</li>
<li>according to the codebook, there are <select class="webex-select"><option value="blank"></option><option value="x">no</option><option value="answer">some</option></select> reverse-coded items in this questionnaire.</li>
</ul>
<p>I have outlined my steps as follows:</p>
<ul>
<li><strong>Step 1</strong>: Reverse-code the single column first because that’s less hassle than having to do that with conditional statements (<code>Supervisor_15_R</code>). <code>mutate()</code> is my friend.</li>
<li><strong>Step 2</strong>: I want to filter out everyone who failed the attention check in <code>Supervisor_7</code>. I can do this with a Boolean expression within the <code>filter()</code> function. The correct response was “completely disagree” which is 1.</li>
<li><strong>Step 3</strong>: Select their id from time point 2 and all the columns that start with the word “super”, apart from <code>Supervisor_7</code> and the original <code>Supervisor_15_R</code> column</li>
<li><strong>Step 4</strong>: pivot into long format so I can calculate the averages better</li>
<li><strong>Step 5</strong>: calculate the average scores per participant</li>
</ul>
<p>I’ve started coding but there are some errors in my code. Help me find and fix all of them. Try to go through the code line by line and read the error messages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>super <span class="ot">&lt;-</span> data_ppr <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">mutate</span>(<span class="at">Supervisor_15 =</span> <span class="dv">9</span><span class="sc">-</span>supervisor_15_R) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">filter</span>(<span class="at">Supervisor_7 =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="fu">select</span>(Code, <span class="fu">starts_with</span>(<span class="st">"Super"</span>), <span class="sc">-</span>Supervisor_7, <span class="sc">-</span>Supervisor_15_R) </span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="fu">pivot_wider</span>(<span class="at">cols =</span> <span class="sc">-</span>Code, <span class="at">names_to =</span> <span class="st">"Item"</span>, <span class="at">values_to =</span> <span class="st">"Response"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-6"><a href="#cb26-6"></a>  <span class="fu">group_by</span>(Time2_Code) <span class="sc">%&gt;%</span> </span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="fu">summarise</span>(<span class="at">Mean_Supervisor_Support =</span> <span class="fu">mean</span>(Score_corrected, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-8"><a href="#cb26-8"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How many mistakes am I supposed to find?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are 8 mistakes in the code.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reveal solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Did you spot all 8 mistakes? Let’s go through them line by line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>super <span class="ot">&lt;-</span> data_prp <span class="sc">%&gt;%</span> <span class="co"># spelling mistake in data object</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">mutate</span>(<span class="at">Supervisor_15 =</span> <span class="dv">8</span><span class="sc">-</span>Supervisor_15_R) <span class="sc">%&gt;%</span> <span class="co"># semantic error: 8 minus response for a 7-point scale and supervisor_15_R needs a capital S</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">filter</span>(Supervisor_7 <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># needs a Boolean expression == instead of =</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">select</span>(Code, <span class="fu">starts_with</span>(<span class="st">"Super"</span>), <span class="sc">-</span>Supervisor_7, <span class="sc">-</span>Supervisor_15_R) <span class="sc">%&gt;%</span> <span class="co"># no pipe at the end, the rest is actually legit</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Code, <span class="at">names_to =</span> <span class="st">"Item"</span>, <span class="at">values_to =</span> <span class="st">"Response"</span>) <span class="sc">%&gt;%</span> <span class="co"># pivot_longer instead of pivot_wider</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>  <span class="fu">group_by</span>(Code) <span class="sc">%&gt;%</span> <span class="co"># Code rather than Time2_Code - the reduced dataset does not contain Time2_Code</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>  <span class="fu">summarise</span>(<span class="at">Mean_Supervisor_Support =</span> <span class="fu">mean</span>(Response, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> <span class="co"># Score_corrected doesn't exist; needs to be Response</span></span>
<span id="cb27-8"><a href="#cb27-8"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Note that the <strong>semantic error</strong> in line 2 will not give you an error message.</li>
<li>Were you thrown off by the <code>starts_with("Super")</code> expression in line 4? <code>starts_with()</code> and <code>ends_with()</code> are great alternatives to selecting columns via <code>:</code> But, using <code>select(Code, Supervisor_1:Supervisor_6, Supervisor_8:Supervisor_14)</code> would have given us the same result. <em>[I admit, that one was perhaps a bit mean]</em></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="activity-6-join-everything-together-with-_join" class="level2" data-number="3.6">
<h2 data-number="3.6" data-anchor-id="activity-6-join-everything-together-with-_join"><span class="header-section-number">3.6</span> Activity 6: Join everything together with <code>???_join()</code></h2>
<p>Time to join all the relevant data files into a single dataframe, which will be used in the next chapters on data visualization. There are four ways to join data: <code>inner_join()</code>, <code>left_join()</code>, <code>right_join()</code>, and <code>full_join()</code>. Each function behaves differently in terms of what information is retained from the two data objects. Here is a quick overview:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Info on mutating joins
</div>
</div>
<div class="callout-body-container callout-body">
<p>You have 4 types of join functions you could make use of. Click on the panels to know more</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><code>inner_join()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><code>left_join()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false"><code>right_join()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false"><code>full_join()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p><code>inner_join()</code> returns only the rows where the values in the column specified in the <code>by =</code> statement match in both tables.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/inner-join.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="inner_join(): gif by Garrick Aden-Buie"><img src="images/inner-join.gif" class="img-fluid figure-img" alt="inner_join(): gif by Garrick Aden-Buie"></a></p>
<figcaption>inner_join(): gif by <a href="https://www.garrickadenbuie.com/project/tidyexplain/" target="_blank">Garrick Aden-Buie</a></figcaption>
</figure>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p><code>left_join()</code> retains the complete first (left) table and adds values from the second (right) table that have matching values in the column specified in the <code>by =</code> statement. Rows in the left table with no match in the right table will have missing values (<code>NA</code>) in the new columns.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/left-join.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="left_join(): gif by Garrick Aden-Buie"><img src="images/left-join.gif" class="img-fluid figure-img" alt="left_join(): gif by Garrick Aden-Buie"></a></p>
<figcaption>left_join(): gif by <a href="https://www.garrickadenbuie.com/project/tidyexplain/" target="_blank">Garrick Aden-Buie</a></figcaption>
</figure>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p><code>right_join()</code> retains the complete second (right) table and adds values from the first (left) table that have matching values in the column specified in the <code>by =</code> statement. Rows in the right table with no match in the left table will have missing values (<code>NA</code>) in the new columns.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/right-join.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="right_join(): gif by Garrick Aden-Buie"><img src="images/right-join.gif" class="img-fluid figure-img" alt="right_join(): gif by Garrick Aden-Buie"></a></p>
<figcaption>right_join(): gif by <a href="https://www.garrickadenbuie.com/project/tidyexplain/" target="_blank">Garrick Aden-Buie</a></figcaption>
</figure>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<p><code>full_join()</code> returns all rows and all columns from both tables. <code>NA</code> values fill unmatched rows.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/full-join.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="full_join(): gif by Garrick Aden-Buie"><img src="images/full-join.gif" class="img-fluid figure-img" alt="full_join(): gif by Garrick Aden-Buie"></a></p>
<figcaption>full_join(): gif by <a href="https://www.garrickadenbuie.com/project/tidyexplain/" target="_blank">Garrick Aden-Buie</a></figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>From our original <code>data_prp</code>, we need to select demographics data and all summarised questionnaire data from time point 2. Next, we will join this with all other aggregated datasets from time point 1 which are currently stored in separate data objects in the <code>Global Environment</code>.</p>
<p>While you may be familiar with <code>inner_join()</code> from last year, for this task, we want to retain all data from all the data objects. Therefore, we will use <code>full_join()</code>. Keep in mind, you can only join two data objects at a time, so the upcoming code chunk will involve a fair bit of piping and joining.</p>
<p>Note: Since I (Gaby) like my columns arranged in a meaningful way, I will use <code>select()</code> at the end to order them better.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>data_prp_final <span class="ot">&lt;-</span> data_prp <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">select</span>(Code<span class="sc">:</span>Plan_prereg, Pre_reg_group<span class="sc">:</span>Time2_Understanding_OS) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">full_join</span>(qrp_t1) <span class="sc">%&gt;%</span> </span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="fu">full_join</span>(understanding_t1) <span class="sc">%&gt;%</span> </span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="fu">full_join</span>(sats_t1) <span class="sc">%&gt;%</span> </span>
<span id="cb28-6"><a href="#cb28-6"></a>  <span class="fu">full_join</span>(super) <span class="sc">%&gt;%</span> </span>
<span id="cb28-7"><a href="#cb28-7"></a>  <span class="fu">select</span>(Code<span class="sc">:</span>Plan_prereg, Pre_reg_group, SATS28_Affect_Time1_mean, SATS28_CognitiveCompetence_Time1_mean, SATS28_Value_Time1_mean, SATS28_Difficulty_Time1_mean, QRPs_Acceptance_Time1_mean, Time1_Understanding_OS, Other_OS_behav_2<span class="sc">:</span>Time2_Understanding_OS, Mean_Supervisor_Support)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
No <code>by</code> argument in the code above?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note how I didn’t include a <code>by</code> argument in the code above. If you leave <code>by =</code> out, R will join the 2 data objects by <strong>ALL</strong> columns that have the same name.</p>
<p><strong>Special case 1: matching column names but different values</strong></p>
<p>If you want more control, you should include the <code>by</code> argument; for example, if both data objects include a column <code>age</code> but data was recorded at 2 different time points. In that case, the information from both <code>age</code> columns should be retained and the <code>by</code> argument would not include <code>age</code>.</p>
<p><strong>Special case 2: different column names but matching values</strong></p>
<p>Another special case presents when both data objects contain identical information but the variable names don’t match. Let’s say, both data objects contain gender information, but in one data object the variable is named <code>gender</code> and in the other one <code>gender_label</code>. In that case, your <code>by</code> argument needs to be modified as: <code>by = join_by(gender == gender_label)</code>.</p>
<p>More info on joins can be found <a href="https://www.tidyverse.org/blog/2023/01/dplyr-1-1-0-joins/" target="_blank">https://www.tidyverse.org/blog/2023/01/dplyr-1-1-0-joins/</a></p>
</div>
</div>
<p>And this is basically the dataset we need for <a href="04-dataviz.html" class="quarto-xref"><span>Chapter 4</span></a> and <a href="05-dataviz2.html" class="quarto-xref"><span>Chapter 5</span></a>.</p>
</section>
<section id="activity-7-knit-and-export" class="level2" data-number="3.7">
<h2 data-number="3.7" data-anchor-id="activity-7-knit-and-export"><span class="header-section-number">3.7</span> Activity 7: Knit and export</h2>
<p>Knit the <code>.Rmd</code> file to ensure everything runs as expected. Once it does, export the data object <code>data_prp_final</code> as a csv for use in the <a href="04-dataviz.html" class="quarto-xref"><span>Chapter 4</span></a>. Name it something meaningful, something like <code>data_prp_for_ch4.csv</code>.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">write_csv</span>(data_prp_final, <span class="st">"data_prp_for_ch4.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="test-your-knowledge-and-challenge-yourself" class="level2 unnumbered">
<h2 class="unnumbered" data-anchor-id="test-your-knowledge-and-challenge-yourself"><span style="color: #F39C12; text-transform: uppercase;">Test your knowledge and challenge yourself</span></h2>
<section id="knowledge-check" class="level3 unnumbered">
<h3 class="unnumbered" data-anchor-id="knowledge-check">Knowledge check</h3>
<section id="question-1" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="question-1">Question 1</h4>
<p>When using <code>mutate()</code>, which additional function could you use to recode an existing variable? <select class="webex-select"><option value="blank"></option><option value="x">arrange()</option><option value="x">filter()</option><option value="answer">case_match()</option><option value="x">case_when()</option></select></p>
</section>
<section id="question-2" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="question-2">Question 2</h4>
<p>When using <code>mutate()</code>, which additional function could you use to create a new variable based on one or multiple conditional statements? <select class="webex-select"><option value="blank"></option><option value="x">arrange()</option><option value="x">filter()</option><option value="x">case_match()</option><option value="answer">case_when()</option></select></p>
</section>
<section id="question-3" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="question-3">Question 3</h4>
<p>Which of the following functions would you use if you wanted to join two data sets by their shared identifier? <select class="webex-select"><option value="blank"></option><option value="answer">inner_join()</option><option value="x">left_join()</option><option value="x">right_join()</option><option value="x">full_join()</option></select></p>
</section>
<section id="question-4" class="level4 unnumbered">
<h4 class="unnumbered" data-anchor-id="question-4">Question 4</h4>
<p>Your data object contains a column <code>Score</code> with numbers, but they have been read in incorrectly as a character datatype. Which of the following functions would <em>not</em> work for fixing this issue? <select class="webex-select"><option value="blank"></option><option value="x">parse_number()</option><option value="answer">factor(Score)</option><option value="x">mutate(Score = as.numeric(Score))</option><option value="x">as.numeric()</option></select></p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Explain this answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><code>parse_number()</code> from the <code>readr</code> package extracts numeric values from strings, so this would work.</li>
<li><code>factor(Score)</code>: This would <em>not</em> work as expected because it converts the column into a factor, not a numeric datatype, leading to incorrect results if numeric operations are needed.</li>
<li><code>mutate(Score = as.numeric(Score))</code>: This would work too because <code>mutate()</code> can be used in combination with <code>as.numeric()</code> to create a new numeric column or override the existing character column.</li>
<li><code>as.numeric()</code>: This would also work to convert a character column to numeric. Without mutate, you could use it in a BaseR way, e.g., <code>data$Score &lt;- as.numeric(data$Score)</code> (<em>shudder, BaseR!!! But effective</em>)</li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="challenge-yourself" class="level3 unnumbered">
<h3 class="unnumbered" data-anchor-id="challenge-yourself">Challenge yourself</h3>
<p>If you want to <strong>challenge yourself</strong> and further apply the skills from Chapter 3, you could wrangle the data from <code>dog_data_raw</code> (<a href="data/data_pair_coding.zip" title="download">lab data</a>) for one of the other questionnaires. There are plenty of options to choose from:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty level: easy
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>recode column <code>Live_Pets</code> so the values read yes and no rather than 1 and 2</li>
<li>recode <code>Year_of_Study</code> so they have the labels from the codebook rather than the numbers</li>
<li>reverse-code the <code>Homesickness</code> scale for <code>_pre</code> and <code>_post</code></li>
<li>renaming the columns of the other one-item scales as <code>Stress_pre</code>, <code>Stress_post</code>, <code>Engagement_pre</code> and <code>Engagement_post</code></li>
</ul>
<p>Any of these tasks should be doable in one step. No need to select or pivot anything. You could just modify <code>dog_data_raw</code>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>For the <strong>recoding tasks</strong>, you need to work out which function to use to recode one value as another - just plain replacing, no conditional statements</li>
<li>The <strong>reverse-coding</strong> might sound daunting to do in one step, but it is only a single value that needs to be recoded. Take some inspiration from Activity 5 (error mode).</li>
<li>For the <strong>renaming tasks</strong>, check how you would change column names without reducing the number of columns overall</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution for <strong>Challenge yourself - easy</strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="do">## Live_Pets</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>dog_data_raw <span class="ot">&lt;-</span> dog_data_raw <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">mutate</span>(<span class="at">Live_Pets =</span> <span class="fu">case_match</span>(Live_Pets,</span>
<span id="cb30-4"><a href="#cb30-4"></a>                                <span class="dv">1</span> <span class="sc">~</span> <span class="st">"yes"</span>,</span>
<span id="cb30-5"><a href="#cb30-5"></a>                                <span class="dv">2</span> <span class="sc">~</span> <span class="st">"no"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="do">## Year of Study</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>dog_data_raw <span class="ot">&lt;-</span> dog_data_raw <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">mutate</span>(<span class="at">Year_of_Study =</span> <span class="fu">case_match</span>(Year_of_Study,</span>
<span id="cb31-4"><a href="#cb31-4"></a>                                    <span class="dv">1</span> <span class="sc">~</span> <span class="st">"First"</span>,</span>
<span id="cb31-5"><a href="#cb31-5"></a>                                    <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Second"</span>,</span>
<span id="cb31-6"><a href="#cb31-6"></a>                                    <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Third"</span>,</span>
<span id="cb31-7"><a href="#cb31-7"></a>                                    <span class="dv">4</span> <span class="sc">~</span> <span class="st">"Fourth"</span>,</span>
<span id="cb31-8"><a href="#cb31-8"></a>                                    <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Fifth or above"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="do">## Reverse-coding of homesickness pre and post. It's a 5-point scale, hence you'd calculate 6-the original response column</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>dog_data_raw <span class="ot">&lt;-</span> dog_data_raw <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">mutate</span>(<span class="at">Homesick_pre =</span> <span class="dv">6</span><span class="sc">-</span>HO1_1,</span>
<span id="cb32-4"><a href="#cb32-4"></a>         <span class="at">Homesick_post =</span> <span class="dv">6</span><span class="sc">-</span>HO2_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="do">## Renaming of Stress and Engagement</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>dog_data_raw <span class="ot">&lt;-</span> dog_data_raw <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">rename</span>(<span class="at">Stress_pre =</span> S1_1, <span class="at">Stress_post =</span> S2_1, <span class="at">Engagement_pre =</span> HO1_2, <span class="at">Engagement_post =</span> HO2_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty level: medium
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>reverse-code the Social connectedness scale (pre-intervention) and compute a mean score per participant</li>
</ul>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This task would take 4 steps to complete. These are the exact same steps we applied to <code>Loneliness_pre</code> in the lab activity. You would just need to figure out which items are related to the Social connectedness scale (pre-intervention) and which ones of those are reverse-coded. The codebook has all the answers.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution for <strong>Challenge yourself - medium</strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="do">## SCS pre</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>scs_pre <span class="ot">&lt;-</span> dog_data_raw <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">select</span>(RID, <span class="fu">starts_with</span>(<span class="st">"SC1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>RID, <span class="at">names_to =</span> <span class="st">"Names"</span>, <span class="at">values_to =</span> <span class="st">"Response"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-5"><a href="#cb34-5"></a>  <span class="fu">mutate</span>(<span class="at">Score_corrected =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-6"><a href="#cb34-6"></a>    Names <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SC1_3"</span>, <span class="st">"SC1_6"</span>, <span class="st">"SC1_7"</span>, <span class="st">"SC1_9"</span>, <span class="st">"SC1_11"</span>, <span class="st">"SC1_13"</span>, <span class="st">"SC1_15"</span>, <span class="st">"SC1_17"</span>, <span class="st">"SC1_18"</span>, <span class="st">"SC1_20"</span>) <span class="sc">~</span> <span class="dv">7</span><span class="sc">-</span>Response,</span>
<span id="cb34-7"><a href="#cb34-7"></a>    <span class="at">.default =</span> Response</span>
<span id="cb34-8"><a href="#cb34-8"></a>    )) <span class="sc">%&gt;%</span> </span>
<span id="cb34-9"><a href="#cb34-9"></a>  <span class="fu">group_by</span>(RID) <span class="sc">%&gt;%</span> </span>
<span id="cb34-10"><a href="#cb34-10"></a>  <span class="fu">summarise</span>(<span class="at">SCS_pre =</span> <span class="fu">mean</span>(Score_corrected, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-11"><a href="#cb34-11"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty level: hard
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>reverse-code the Loneliness scale (post-intervention) and compute a mean score per participant</li>
<li>reverse-code the Social connectedness scale (post-intervention) and compute a mean score per participant</li>
</ul>
<p>Both activities are similar to Activity 3 from the individual walkthrough and would take about 5 steps to complete. <strong>Start by mapping out the steps</strong>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Step 1</strong>: Select all relevant columns, such as participant ID and all the items that belong to the questionnaire that participants completed after the intervention</li>
<li><strong>Step 2</strong>: Pivot the data from wide format to long format so we can reverse-score and calculate the average score more easily</li>
<li><strong>Step 3</strong>: Recode the initial responses so that the new column has numbers instead of labels</li>
<li><strong>Step 4</strong>: Reverse-score the items that are labelled as “Reverse” in the codebook and then reverse-score them</li>
<li><strong>Step 5</strong>: Group by and summarise to calculate the mean Score</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution for <strong>Challenge yourself - hard</strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="do">## loneliness post</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>lonely_post <span class="ot">&lt;-</span> dog_data_raw <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="co"># Step 1</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="fu">select</span>(RID, <span class="fu">starts_with</span>(<span class="st">"L2"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="co"># Step 2</span></span>
<span id="cb35-6"><a href="#cb35-6"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>RID, <span class="at">names_to =</span> <span class="st">"Names"</span>, <span class="at">values_to =</span> <span class="st">"Response"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-7"><a href="#cb35-7"></a>  <span class="co"># Step 3</span></span>
<span id="cb35-8"><a href="#cb35-8"></a>  <span class="fu">mutate</span>(<span class="at">Score =</span> <span class="fu">case_match</span>(Response,</span>
<span id="cb35-9"><a href="#cb35-9"></a>                            <span class="st">"never"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb35-10"><a href="#cb35-10"></a>                            <span class="st">"rarely"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb35-11"><a href="#cb35-11"></a>                            <span class="st">"sometimes"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb35-12"><a href="#cb35-12"></a>                            <span class="st">"often"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb35-13"><a href="#cb35-13"></a>                            <span class="at">.default =</span> <span class="cn">NA</span></span>
<span id="cb35-14"><a href="#cb35-14"></a>  ),</span>
<span id="cb35-15"><a href="#cb35-15"></a>  <span class="co"># Step 4 - we are still in the same mutate function (count the brackets)</span></span>
<span id="cb35-16"><a href="#cb35-16"></a>        <span class="at">Score_corrected =</span> <span class="fu">case_when</span>(</span>
<span id="cb35-17"><a href="#cb35-17"></a>          Names <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"L2_1"</span>, <span class="st">"L2_5"</span>, <span class="st">"L2_6"</span>, <span class="st">"L2_9"</span>, <span class="st">"L2_10"</span>, <span class="st">"L2_15"</span>, <span class="st">"L2_16"</span>, <span class="st">"L2_19"</span>, <span class="st">"L2_20"</span>) <span class="sc">~</span> <span class="dv">5</span><span class="sc">-</span>Score,</span>
<span id="cb35-18"><a href="#cb35-18"></a>          <span class="at">.default =</span> Score</span>
<span id="cb35-19"><a href="#cb35-19"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb35-20"><a href="#cb35-20"></a>  <span class="co"># Step 5</span></span>
<span id="cb35-21"><a href="#cb35-21"></a>  <span class="fu">group_by</span>(RID) <span class="sc">%&gt;%</span> </span>
<span id="cb35-22"><a href="#cb35-22"></a>  <span class="fu">summarise</span>(<span class="at">Loneliness_post =</span> <span class="fu">mean</span>(Score_corrected, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-23"><a href="#cb35-23"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="do">## SCS post</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>scs_post <span class="ot">&lt;-</span> dog_data_raw <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="co"># Step 1</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="fu">select</span>(RID, <span class="fu">starts_with</span>(<span class="st">"SC2"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-5"><a href="#cb36-5"></a>  <span class="co"># Step 2</span></span>
<span id="cb36-6"><a href="#cb36-6"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>RID, <span class="at">names_to =</span> <span class="st">"Names"</span>, <span class="at">values_to =</span> <span class="st">"Response"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-7"><a href="#cb36-7"></a>  <span class="co"># Step 3</span></span>
<span id="cb36-8"><a href="#cb36-8"></a>  <span class="fu">mutate</span>(<span class="at">Response =</span> <span class="fu">case_match</span>(Response,</span>
<span id="cb36-9"><a href="#cb36-9"></a>                               <span class="st">"strongly disagree"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb36-10"><a href="#cb36-10"></a>                               <span class="st">"strongly agree"</span> <span class="sc">~</span> <span class="st">"6"</span>,</span>
<span id="cb36-11"><a href="#cb36-11"></a>                               <span class="at">.default =</span> Response),</span>
<span id="cb36-12"><a href="#cb36-12"></a>         <span class="at">Response =</span> <span class="fu">parse_number</span>(Response),</span>
<span id="cb36-13"><a href="#cb36-13"></a>  <span class="co"># Step 4 - we are still in the same mutate function (count the brackets)</span></span>
<span id="cb36-14"><a href="#cb36-14"></a>         <span class="at">Score_corrected =</span> <span class="fu">case_when</span>(</span>
<span id="cb36-15"><a href="#cb36-15"></a>           Names <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SC2_3"</span>, <span class="st">"SC2_6"</span>, <span class="st">"SC2_7"</span>, <span class="st">"SC2_9"</span>, <span class="st">"SC2_11"</span>, <span class="st">"SC2_13"</span>, <span class="st">"SC2_15"</span>, <span class="st">"SC2_17"</span>, <span class="st">"SC2_18"</span>, <span class="st">"SC2_20"</span>) <span class="sc">~</span> <span class="dv">7</span><span class="sc">-</span>Response,</span>
<span id="cb36-16"><a href="#cb36-16"></a>           <span class="at">.default =</span> Response</span>
<span id="cb36-17"><a href="#cb36-17"></a>         )) <span class="sc">%&gt;%</span> </span>
<span id="cb36-18"><a href="#cb36-18"></a>  <span class="co"># Step 5</span></span>
<span id="cb36-19"><a href="#cb36-19"></a>  <span class="fu">group_by</span>(RID) <span class="sc">%&gt;%</span> </span>
<span id="cb36-20"><a href="#cb36-20"></a>  <span class="fu">summarise</span>(<span class="at">SCS_post =</span> <span class="fu">mean</span>(Score_corrected, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-21"><a href="#cb36-21"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Difficulty level: extra hard
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>PANAS: positive and negative affect of pre- and post-intervention in a single pipe rather than in 4 different data objects (see last week’s)</li>
</ul>
<p>This task would take about 7 steps to get it from</p>
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">RID</th>
<th style="text-align: right;">PN1_1</th>
<th style="text-align: right;">PN1_2</th>
<th style="text-align: right;">PN1_3</th>
<th style="text-align: right;">PN1_4</th>
<th style="text-align: right;">PN1_5</th>
<th style="text-align: right;">PN1_6</th>
<th style="text-align: right;">PN1_7</th>
<th style="text-align: right;">PN1_8</th>
<th style="text-align: right;">PN1_9</th>
<th style="text-align: right;">PN1_10</th>
<th style="text-align: right;">PN2_1</th>
<th style="text-align: right;">PN2_2</th>
<th style="text-align: right;">PN2_3</th>
<th style="text-align: right;">PN2_4</th>
<th style="text-align: right;">PN2_5</th>
<th style="text-align: right;">PN2_6</th>
<th style="text-align: right;">PN2_7</th>
<th style="text-align: right;">PN2_8</th>
<th style="text-align: right;">PN2_9</th>
<th style="text-align: right;">PN2_10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>to</p>
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">RID</th>
<th style="text-align: left;">Stage</th>
<th style="text-align: right;">PANAS_NA</th>
<th style="text-align: right;">PANAS_PA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">post</td>
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">3.8</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: left;">pre</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3.2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">post</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">pre</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">post</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">3.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Start by mapping out the steps</strong></p>
<ul>
<li><strong>Step 1</strong>: select all relevant columns, such as participant ID and all the items that belong to PANAs scale (pos, neg, pre, and post)</li>
<li><strong>Step 2</strong>: pivot the data from wide format to long format. You want to do that for ALL columns that are not the participant id. The data object should have 3 columns and 5680 observations, i.e.&nbsp;each participant has 20 rows.</li>
<li><strong>Step 3</strong>: All of the items will have the structure <code>PN1_1</code>. Use separate to split the information across 2 columns. First column has information about the <code>Stage</code>, second column should turn into an <code>Item_number</code> and it should convert into a numeric column in the process to save you typing quotation marks in Step 5.<br>
</li>
<li><strong>Step 4</strong>: recode the <code>Stage</code> column you just created so that everything that starts with PN1 relates to “pre” and PN2 as post.</li>
<li><strong>Step 5</strong>: identify the subscales positive affect (PA) and negative affect (NA) by item number and recode them. This requires a conditional statement.</li>
<li><strong>Step 6</strong>: group by and summarise to calculate the mean Score</li>
<li><strong>Step 7</strong>: pivot, so that you have the 2 PANAS subscales presented in separate columns (see table above). You might need an extra step if the columns aren’t labelled exactly as shown in the table above.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution for <strong>Challenge yourself - extra hard</strong>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>PANAS <span class="ot">&lt;-</span> dog_data_raw <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="co"># Step 1</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="fu">select</span>(RID, <span class="fu">starts_with</span>(<span class="st">"PN"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="co"># Step 2</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>RID, <span class="at">names_to =</span> <span class="st">"Items"</span>, <span class="at">values_to =</span> <span class="st">"Scores"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-6"><a href="#cb37-6"></a>  <span class="co"># Step 3</span></span>
<span id="cb37-7"><a href="#cb37-7"></a>  <span class="fu">separate</span>(Items, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"Stage"</span>, <span class="st">"Item_number"</span>), <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-8"><a href="#cb37-8"></a>  <span class="co"># Step 4 recode Stage</span></span>
<span id="cb37-9"><a href="#cb37-9"></a>  <span class="fu">mutate</span>(<span class="at">Stage =</span> <span class="fu">case_match</span>(Stage,</span>
<span id="cb37-10"><a href="#cb37-10"></a>                            <span class="st">"PN1"</span> <span class="sc">~</span> <span class="st">"pre"</span>,</span>
<span id="cb37-11"><a href="#cb37-11"></a>                            <span class="st">"PN2"</span> <span class="sc">~</span> <span class="st">"post"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-12"><a href="#cb37-12"></a>  <span class="co"># Step 5 identify subscales by item number</span></span>
<span id="cb37-13"><a href="#cb37-13"></a>  <span class="fu">mutate</span>(<span class="at">Subscales =</span> <span class="fu">case_when</span>(</span>
<span id="cb37-14"><a href="#cb37-14"></a>    Item_number <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">10</span>) <span class="sc">~</span> <span class="st">"PANAS_PA"</span>,</span>
<span id="cb37-15"><a href="#cb37-15"></a>    <span class="at">.default =</span> <span class="st">"PANAS_NA"</span></span>
<span id="cb37-16"><a href="#cb37-16"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb37-17"><a href="#cb37-17"></a>  <span class="co"># Step 6 </span></span>
<span id="cb37-18"><a href="#cb37-18"></a>  <span class="fu">group_by</span>(RID, Stage, Subscales) <span class="sc">%&gt;%</span> </span>
<span id="cb37-19"><a href="#cb37-19"></a>  <span class="fu">summarise</span>(<span class="at">Score =</span> <span class="fu">mean</span>(Scores)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-20"><a href="#cb37-20"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-21"><a href="#cb37-21"></a>  <span class="co"># Step 7 - to make the data look like the data in `dog_data_clean_long.csv`</span></span>
<span id="cb37-22"><a href="#cb37-22"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Subscales, <span class="at">values_from =</span> Score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script>



/* update total correct if #webex-total_correct exists */

update_total_correct = function() {

  console.log("webex: update total_correct");



  var t = document.getElementsByClassName("webex-total_correct");

  for (var i = 0; i < t.length; i++) {

    p = t[i].parentElement;

    var correct = p.getElementsByClassName("webex-correct").length;

    var solvemes = p.getElementsByClassName("webex-solveme").length;

    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;

    var selects = p.getElementsByClassName("webex-select").length;



    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";

  }

}



/* webex-solution button toggling function */

b_func = function() {

  console.log("webex: toggle hide");



  var cl = this.parentElement.classList;

  if (cl.contains('open')) {

    cl.remove("open");

  } else {

    cl.add("open");

  }

}



/* check answers */

check_func = function() {

  console.log("webex: check answers");



  var cl = this.parentElement.classList;

  if (cl.contains('unchecked')) {

    cl.remove("unchecked");

    this.innerHTML = "Hide Answers";

  } else {

    cl.add("unchecked");

    this.innerHTML = "Show Answers";

  }

}



/* function for checking solveme answers */

solveme_func = function(e) {

  console.log("webex: check solveme");



  var real_answers = JSON.parse(this.dataset.answer);

  var my_answer = this.value;

  var cl = this.classList;

  if (cl.contains("ignorecase")) {

    my_answer = my_answer.toLowerCase();

  }

  if (cl.contains("nospaces")) {

    my_answer = my_answer.replace(/ /g, "")

  }



  if (my_answer == "") {

    cl.remove("webex-correct");

    cl.remove("webex-incorrect");

  } else if (real_answers.includes(my_answer)) {

    cl.add("webex-correct");

    cl.remove("webex-incorrect");

  } else {

    cl.add("webex-incorrect");

    cl.remove("webex-correct");

  }



  // match numeric answers within a specified tolerance

  if(this.dataset.tol > 0){

    var tol = JSON.parse(this.dataset.tol);

    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)

    if (matches.reduce((a, b) => a + b, 0) > 0) {

      cl.add("webex-correct");

    } else {

      cl.remove("webex-correct");

    }

  }



  // added regex bit

  if (cl.contains("regex")){

    answer_regex = RegExp(real_answers.join("|"))

    if (answer_regex.test(my_answer)) {

      cl.add("webex-correct");

    }

  }



  update_total_correct();

}



/* function for checking select answers */

select_func = function(e) {

  console.log("webex: check select");



  var cl = this.classList



  /* add style */

  cl.remove("webex-incorrect");

  cl.remove("webex-correct");

  if (this.value == "answer") {

    cl.add("webex-correct");

  } else if (this.value != "blank") {

    cl.add("webex-incorrect");

  }



  update_total_correct();

}



/* function for checking radiogroups answers */

radiogroups_func = function(e) {

  console.log("webex: check radiogroups");



  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');

  var cl = checked_button.parentElement.classList;

  var labels = checked_button.parentElement.parentElement.children;



  /* get rid of styles */

  for (i = 0; i < labels.length; i++) {

    labels[i].classList.remove("webex-incorrect");

    labels[i].classList.remove("webex-correct");

  }



  /* add style */

  if (checked_button.value == "answer") {

    cl.add("webex-correct");

  } else {

    cl.add("webex-incorrect");

  }



  update_total_correct();

}



window.onload = function() {

  console.log("webex onload");

  /* set up solution buttons */

  var buttons = document.getElementsByTagName("button");



  for (var i = 0; i < buttons.length; i++) {

    if (buttons[i].parentElement.classList.contains('webex-solution')) {

      buttons[i].onclick = b_func;

    }

  }



  var check_sections = document.getElementsByClassName("webex-check");

  console.log("check:", check_sections.length);

  for (var i = 0; i < check_sections.length; i++) {

    check_sections[i].classList.add("unchecked");



    let btn = document.createElement("button");

    btn.innerHTML = "Show Answers";

    btn.classList.add("webex-check-button");

    btn.onclick = check_func;

    check_sections[i].appendChild(btn);



    let spn = document.createElement("span");

    spn.classList.add("webex-total_correct");

    check_sections[i].appendChild(spn);

  }



  /* set up webex-solveme inputs */

  var solveme = document.getElementsByClassName("webex-solveme");



  for (var i = 0; i < solveme.length; i++) {

    /* make sure input boxes don't auto-anything */

    solveme[i].setAttribute("autocomplete","off");

    solveme[i].setAttribute("autocorrect", "off");

    solveme[i].setAttribute("autocapitalize", "off");

    solveme[i].setAttribute("spellcheck", "false");

    solveme[i].value = "";



    /* adjust answer for ignorecase or nospaces */

    var cl = solveme[i].classList;

    var real_answer = solveme[i].dataset.answer;

    if (cl.contains("ignorecase")) {

      real_answer = real_answer.toLowerCase();

    }

    if (cl.contains("nospaces")) {

      real_answer = real_answer.replace(/ /g, "");

    }

    solveme[i].dataset.answer = real_answer;



    /* attach checking function */

    solveme[i].onkeyup = solveme_func;

    solveme[i].onchange = solveme_func;



    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")

  }



  /* set up radiogroups */

  var radiogroups = document.getElementsByClassName("webex-radiogroup");

  for (var i = 0; i < radiogroups.length; i++) {

    radiogroups[i].onchange = radiogroups_func;

  }



  /* set up selects */

  var selects = document.getElementsByClassName("webex-select");

  for (var i = 0; i < selects.length; i++) {

    selects[i].onchange = select_func;

    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")

  }



  update_total_correct();

}



</script>

<script>

// open rdrr links externally ----



var exlinks = document.querySelectorAll("a[href^='https://rdrr.io']");

var exlink_func = function(){

  window.open(this.href);

  return false;

};

for (var i = 0; i < exlinks.length; i++) {

    exlinks[i].addEventListener('click', exlink_func, false);

}



// visible second sidebar in mobile ----



function move_sidebar() {

  var toc = document.getElementById("TOC");

  var small_sidebar = document.querySelector("#quarto-sidebar .sidebar-menu-container");

  var right_sidebar = document.getElementById("quarto-margin-sidebar");



  if (window.innerWidth < 768) {

    small_sidebar.append(toc);

  } else {

    right_sidebar.append(toc);

  }

}

move_sidebar();

window.onresize = move_sidebar;

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-wrangling.html" class="pagination-link" aria-label="Data wrangling I">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data wrangling I</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-dataviz.html" class="pagination-link" aria-label="Data viz I">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data viz I</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>CC-BY (2025) Gaby Mahrholz Carolina E. Kuepper-Tetzel</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","descPosition":"bottom","closeEffect":"zoom","openEffect":"zoom","loop":false});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>