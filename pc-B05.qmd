# 2B Lab 5 Week 7  {.unnumbered}


```{r include=FALSE}
library(webexercises)
```

**This is the pair coding activity related to @sec-oneway.**


## Task 1: Open the R project for the lab {.unnumbered}

## Task 2: Create a new `.Rmd` file {.unnumbered}

## Task 3: Load in the library and read in the data {.unnumbered}

The data should already be in your project folder. If you want a fresh copy, you can download the data again here: [data_pair_coding](data/data_pair_coding.zip "download").

We are using the packages `rstatix`, `tidyverse`, `qqplotr`, and `car` today.

Just like last week, we also need to read in `dog_data_clean_wide.csv`. 

```{r reading in data for me, echo=FALSE, message=FALSE}
library(rstatix)
library(tidyverse)
library(qqplotr)
library(car)

dog_data_wide <- read_csv("data/dog_data_clean_wide.csv")

dog_anova <- dog_data_wide %>%
  select(RID, GroupAssignment, PANAS_PA_post) %>% 
  mutate(GroupAssignment = factor(GroupAssignment))

```


## Task 4: Tidy data & Selecting variables of interest {.unnumbered}

Let's define a potential research question:

**How does the type of interaction with dogs (control, indirect contact, direct contact) affect Positive Affect (PA) scores on the PANAS?**


To get the data into shape, we should **select our variables of interest** from `dog_data_wide` and **convert the intervention group into a factor** . Store this reduced dataset in an object called `dog_anova`.



::: {.callout-caution collapse="true" icon="false"} 

## Solution 

```{r eval=FALSE}
library(rstatix)
library(tidyverse)
library(qqplotr)
library(car)

dog_data_wide <- read_csv("dog_data_clean_wide.csv")

dog_anova <- dog_data_wide %>%
  select(RID, GroupAssignment, PANAS_PA_post) %>% 
  mutate(GroupAssignment = factor(GroupAssignment))
  
```
:::

## Task 5: Model creating & Assumption checks {.unnumbered}

Now, let's create our ANOVA model.

According to our research question, we have the following model variables: 

* Dependent Variable (DV): levels of positive emotions, as assessed by the PANAS, at post intervention
* Independent Variable (IV): Intervention Group (control, indirect contact, direct contact)


As a reminder, the ANOVA model has the following structure:

```{r eval=FALSE}
lm(DV ~ IV, data)
```


Let’s use this approach with our variables and store the model in a separate object called mod:


```{r}
mod <- lm(PANAS_PA_post ~ GroupAssignment, data = dog_anova)
```

Lets check some assumptions:

You see the following output.

```{r}
ggplot(dog_anova, aes(sample = PANAS_PA_post, fill = GroupAssignment)) +
  stat_qq_band(alpha = 0.5) +
  stat_qq_line() +
  stat_qq_point() +
  facet_wrap(~GroupAssignment) +
  theme_bw() +
  scale_fill_viridis_d()
```

* Which assumption was checked in the plot above? `r fitb(c("Normality", "normality"))`
* Does the assumption hold? `r mcq(c(answer = "Yes", "No"))`



```{r eval=FALSE}
leveneTest(PANAS_PA_post ~ GroupAssignment, data = dog_anova)
```
You run the line of code above and the outcome of the Levene's test is reported as $F(2,277) = 0.68, p = .507$. What does that mean?

`r longmcq(sample(c(answer = "The p-value is non-significant, and the assumption of homogeneity of variance is met.", x = "The p-value is non-significant, and the assumption of homogeneity of variance is violated.", x = "The p-value is significant, and the assumption of homogeneity of variance is met.", x = "The p-value is significant, and the assumption of homogeneity of variance is violated.")))`


## Task 6: Interpreting the output {.unnumbered}


```{r}
anova_test(mod, type = 2, effect.size = "pes")
```

How do you interpret the results?

`r longmcq(sample(c(answer = "The effect of GroupAssignment is not significant, indicating no meaningful difference between groups.", x = "The effect of GroupAssignment is significant, meaning at least one group differs from the others.", x = "The effect size (ηₚ² = 0.504) suggests a large effect of GroupAssignment on the outcome variable.", x = "The F-value (F = 0.687) suggests a moderate effect, but more comparisons are needed." )))`
